2025-07-16 08:06:10 INFO configuração de logging concluída
2025-07-16 08:06:10 INFO ==== INÍCIO DA ETAPA DE INGESTÃO ====
2025-07-16 08:06:16 INFO SparkSession com suporte a Delta iniciada
2025-07-16 08:06:20 INFO raw data carregada: 135226 linhas, 3 colunas
2025-07-16 08:06:21 INFO interim CSV salvo em data/interim/vendas_interim.csv
2025-07-16 08:06:27 INFO interim Delta salvo em data/interim/vendas_interim.delta
2025-07-16 08:06:27 INFO ==== FIM DA ETAPA DE INGESTÃO ====
2025-07-16 08:06:27 INFO ingestão concluída com sucesso
2025-07-16 08:06:27 INFO SparkSession finalizada
2025-07-16 08:06:27 INFO Closing down clientserver connection
2025-07-16 08:06:50 [INFO] pipeline - ==== CONFIGURAÇÃO DE LOG DE PREPROCESSAMENTO ====
2025-07-16 08:06:57 [INFO] pipeline - SparkSession com suporte a Delta iniciada
2025-07-16 08:06:57 [INFO] pipeline - ==== INÍCIO DA ETAPA DE PREPROCESSAMENTO ====
2025-07-16 08:06:57 [INFO] pipeline - lendo Delta de entrada em data/interim/vendas_interim.delta
2025-07-16 08:07:04 [INFO] pipeline - dados brutos carregados: 135226 linhas
2025-07-16 08:07:04 [INFO] pipeline - agrupadas duplicatas por sku+data
2025-07-16 08:07:04 [INFO] pipeline - gerada malha completa de datas por SKU
2025-07-16 08:07:04 [INFO] pipeline - marcado campo is_imputed
2025-07-16 08:07:04 [INFO] pipeline - preenchidos valores nulos de venda com zero
2025-07-16 08:07:04 [INFO] pipeline - ordenado por sku e data
2025-07-16 08:07:08 [INFO] pipeline - CSV processado salvo em data/processed/vendas_processed.csv
2025-07-16 08:07:13 [INFO] pipeline - Delta processado salvo em data/processed/vendas_processed.delta
2025-07-16 08:07:13 [INFO] pipeline - ==== FIM DA ETAPA DE PREPROCESSAMENTO ====
2025-07-16 08:07:13 [INFO] pipeline - SparkSession finalizada
2025-07-16 08:07:13 [INFO] py4j.clientserver - Closing down clientserver connection
2025-07-16 08:07:29 [INFO] pipeline - ==== CONFIGURAÇÃO DE LOG DE FEATURE ENGINEERING ====
2025-07-16 08:07:36 [INFO] pipeline - SparkSession com suporte a Delta iniciada para features
2025-07-16 08:07:36 [INFO] pipeline - ==== INÍCIO DA FEATURE ENGINEERING ====
2025-07-16 08:07:36 [INFO] pipeline - Features: lendo Delta de entrada em data/processed/vendas_processed.delta
2025-07-16 08:07:43 [INFO] pipeline - Features: dados brutos carregados (230704 linhas)
2025-07-16 08:07:43 [INFO] pipeline - Features: flag de imputação criado
2025-07-16 08:07:44 [INFO] pipeline - Features: lags [1, 7, 14] criados
2025-07-16 08:07:44 [INFO] pipeline - Features: rolling windows [7, 14, 30] criados
2025-07-16 08:07:44 [INFO] pipeline - Features: variáveis de calendário criadas
2025-07-16 08:07:47 [INFO] pipeline - Features: CSV salvo em data/features/vendas_features.csv
2025-07-16 08:07:51 [INFO] pipeline - Features: Delta salvo em data/features/vendas_features.delta
2025-07-16 08:07:51 [INFO] pipeline - ==== FIM DA FEATURE ENGINEERING ====
2025-07-16 08:07:51 [INFO] pipeline - SparkSession finalizada
2025-07-16 08:07:51 [INFO] py4j.clientserver - Closing down clientserver connection
2025-07-16 08:08:19 [INFO] pipeline - ==== INÍCIO LIGHTGBM ====
2025-07-16 08:08:19 [INFO] pipeline - Dados brutos carregados: (230704, 14)
2025-07-16 08:08:22 [INFO] pipeline - Features geradas: (230704, 14)
2025-07-16 08:08:22 [INFO] pipeline - Colunas de feature: ['is_imputed', 'was_imputed', 'lag_1', 'lag_7', 'lag_14', 'roll_mean_7', 'roll_mean_14', 'roll_mean_30', 'weekday', 'is_weekend', 'month']
2025-07-16 08:08:23 [INFO] pipeline - fold 1 RMSE 5.1329
2025-07-16 08:08:24 [INFO] pipeline - fold 2 RMSE 6.2467
2025-07-16 08:08:25 [INFO] pipeline - fold 3 RMSE 79.7516
2025-07-16 08:08:26 [INFO] pipeline - fold 4 RMSE 4.9785
2025-07-16 08:08:28 [INFO] pipeline - fold 5 RMSE 4.8937
2025-07-16 08:08:28 [INFO] pipeline - CV RMSE média 20.2007
2025-07-16 08:08:29 [INFO] pipeline - Modelo salvo em data/models/lgbm_model.pkl
2025-07-16 08:08:32 [INFO] pipeline - Previsto dia 2024-04-09
2025-07-16 08:08:34 [INFO] pipeline - Previsto dia 2024-04-10
2025-07-16 08:08:35 [INFO] pipeline - Previsto dia 2024-04-11
2025-07-16 08:08:37 [INFO] pipeline - Previsto dia 2024-04-12
2025-07-16 08:08:39 [INFO] pipeline - Previsto dia 2024-04-13
2025-07-16 08:08:40 [INFO] pipeline - Previsto dia 2024-04-14
2025-07-16 08:08:42 [INFO] pipeline - Previsto dia 2024-04-15
2025-07-16 08:08:42 [INFO] pipeline - Forecast salvo em data/models/ml_forecast.csv
2025-07-16 08:08:51 [INFO] pipeline - ==== INÍCIO CATBOOST ====
2025-07-16 08:08:51 [INFO] pipeline - Dados brutos carregados: (230704, 14)
2025-07-16 08:08:53 [INFO] pipeline - Features geradas: (230704, 14)
2025-07-16 08:08:53 [INFO] pipeline - Colunas de feature: ['is_imputed', 'was_imputed', 'lag_1', 'lag_7', 'lag_14', 'roll_mean_7', 'roll_mean_14', 'roll_mean_30', 'weekday', 'is_weekend', 'month']
2025-07-16 08:08:54 [INFO] pipeline - fold 1 RMSE 5.2134
2025-07-16 08:08:54 [INFO] pipeline - fold 2 RMSE 6.3197
2025-07-16 08:08:55 [INFO] pipeline - fold 3 RMSE 80.1870
2025-07-16 08:08:56 [INFO] pipeline - fold 4 RMSE 5.3907
2025-07-16 08:08:57 [INFO] pipeline - fold 5 RMSE 5.2189
2025-07-16 08:08:57 [INFO] pipeline - CV RMSE média 20.4659
2025-07-16 08:08:59 [INFO] pipeline - Modelo salvo em data/models/catboost_model.cbm
2025-07-16 08:09:01 [INFO] pipeline - Previsto dia 2024-04-09
2025-07-16 08:09:03 [INFO] pipeline - Previsto dia 2024-04-10
2025-07-16 08:09:05 [INFO] pipeline - Previsto dia 2024-04-11
2025-07-16 08:09:06 [INFO] pipeline - Previsto dia 2024-04-12
2025-07-16 08:09:08 [INFO] pipeline - Previsto dia 2024-04-13
2025-07-16 08:09:10 [INFO] pipeline - Previsto dia 2024-04-14
2025-07-16 08:09:12 [INFO] pipeline - Previsto dia 2024-04-15
2025-07-16 08:09:12 [INFO] pipeline - Forecast salvo em data/models/catboost_forecast.csv
2025-07-16 08:09:37 [INFO] pipeline - ==== CONFIGURAÇÃO DE LOG DE RECONCILIAÇÃO ====
2025-07-16 08:09:37 [INFO] pipeline - ==== INÍCIO DA RECONCILIAÇÃO ====
2025-07-16 08:09:37 [INFO] pipeline - Lendo forecast LightGBM de data/models/ml_forecast.csv
2025-07-16 08:09:37 [INFO] pipeline - ML forecast: 240210 linhas
2025-07-16 08:09:37 [INFO] pipeline - Lendo forecast CatBoost de data/models/catboost_forecast.csv
2025-07-16 08:09:37 [INFO] pipeline - CatBoost forecast: 240210 linhas
2025-07-16 08:09:37 [INFO] pipeline - Lendo histórico processado de data/processed/vendas_processed.csv
2025-07-16 08:09:37 [INFO] pipeline - Histórico: 230704 linhas (arquivo: data/processed/vendas_processed.csv/part-00000-41109138-f048-4047-8a01-fdf8c23e6272-c000.csv)
2025-07-16 08:09:37 [INFO] pipeline - Criado campo 'reconciled' = média de lgbm_pred e cb_pred
2025-07-16 08:09:37 [INFO] pipeline - Computado resumo diário agregado
2025-07-16 08:09:38 [INFO] pipeline - Reconciled SKU-level salvo em data/models/reconciled_sku_forecast.csv
2025-07-16 08:09:38 [INFO] pipeline - Reconciled daily summary salvo em data/models/reconciled_daily_summary.csv
2025-07-16 08:09:38 [INFO] pipeline - ==== FIM DA RECONCILIAÇÃO ====
2025-07-16 08:09:47 [INFO] pipeline - ==== CONFIGURAÇÃO DE LOG DE AVALIAÇÃO ====
2025-07-16 08:09:47 [INFO] pipeline - ==== INÍCIO DA AVALIAÇÃO DE MÉTRICAS ====
2025-07-16 08:09:47 [INFO] pipeline - ==== CARREGANDO DADOS PARA AVALIAÇÃO ====
2025-07-16 08:09:47 [INFO] pipeline - Lido data/processed/vendas_processed.csv/part-00000-41109138-f048-4047-8a01-fdf8c23e6272-c000.csv: 230704 linhas, 4 colunas
2025-07-16 08:09:47 [INFO] pipeline - Lido data/models/ml_forecast.csv: 240210 linhas, 3 colunas
2025-07-16 08:09:47 [INFO] pipeline - Lido data/models/catboost_forecast.csv: 240210 linhas, 3 colunas
2025-07-16 08:09:47 [INFO] pipeline - Lido data/models/reconciled_sku_forecast.csv: 240210 linhas, 6 colunas
2025-07-16 08:09:47 [INFO] pipeline - lgbm granular: {'rmse': 7.811415691738551, 'mae': 2.9708396018641117, 'r2': 0.9631759154876885, 'mape': np.float64(16.213734197184998), 'wmape': np.float64(19.449311029643642)}
2025-07-16 08:09:47 [INFO] pipeline - lgbm aggregate: {'rmse': 3050.288541138267, 'mae': 2110.394269946974, 'r2': 0.9612587860286518, 'mape': np.float64(5.471137207253645), 'wmape': np.float64(5.150293071883756)}
2025-07-16 08:09:47 [INFO] pipeline - catboost granular: {'rmse': 7.26416873984058, 'mae': 3.1833172156499354, 'r2': 0.9681547760956566, 'mape': np.float64(26.59869150105079), 'wmape': np.float64(20.840346477926992)}
2025-07-16 08:09:47 [INFO] pipeline - catboost aggregate: {'rmse': 3444.4884227871694, 'mae': 2482.9131297057074, 'r2': 0.9505984201613915, 'mape': np.float64(6.431938659256674), 'wmape': np.float64(6.059403435706743)}
2025-07-16 08:09:47 [INFO] pipeline - reconciled granular: {'rmse': 7.299259760204431, 'mae': 3.042721228576602, 'r2': 0.9678463635162216, 'mape': np.float64(20.517589540207407), 'wmape': np.float64(19.91990126762577)}
2025-07-16 08:09:47 [INFO] pipeline - reconciled aggregate: {'rmse': 3221.5631630415396, 'mae': 2281.461934426957, 'r2': 0.9567859788383013, 'mape': np.float64(5.905939264575375), 'wmape': np.float64(5.567773643993501)}
2025-07-16 08:09:47 [INFO] pipeline - Metrics report salvo em data/models/metrics_report.csv
2025-07-16 08:09:47 [INFO] pipeline - ==== FIM DA AVALIAÇÃO DE MÉTRICAS ====
2025-07-16 08:10:00 [INFO] pipeline - ==== INÍCIO FORECAST SKU=2020 ====
2025-07-16 08:10:00 [INFO] pipeline - Carregando LGBM de data/models/lgbm_model.pkl
2025-07-16 08:10:00 [INFO] pipeline - Carregando CatBoost de data/models/catboost_model.cbm
2025-07-16 08:10:00 [INFO] pipeline - Histórico SKU=2020: 82 linhas (arquivo: data/processed/vendas_processed.csv/part-00000-41109138-f048-4047-8a01-fdf8c23e6272-c000.csv)
2025-07-16 08:10:01 [INFO] pipeline - Features SKU=2020: 82 linhas (arquivo: data/features/vendas_features.csv/part-00000-40689c1d-1a80-468b-81ac-d69d82a51cf5-c000.csv)
2025-07-16 08:10:01 [INFO] pipeline - Gerado forecast SKU=2020 com 89 linhas
2025-07-16 08:10:01 [INFO] pipeline - Forecast SKU salvo em data/models/forecast_sku_2020.csv
2025-07-16 08:10:01 [INFO] pipeline - ==== FIM FORECAST SKU=2020 ====
